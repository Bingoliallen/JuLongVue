export default {
    bind(el, binding) {
        const SELECTWRAP_DOM = el.querySelector('.el-scrollbar .el-scrollbar__wrap');

        SELECTWRAP_DOM.addEventListener('scroll', function(e) {
            // 记录之前的滚动高度，新增数据导致滚动高度和滚动位置发生变化
            let scrollHeightLatest = this.scrollHeightLatest;

            if (scrollHeightLatest && scrollHeightLatest != this.scrollHeight) {
                // 滚动高度发生变化，滚动位置滚动回原来的位置
                this.scrollTop = this.scrollTopLatest;
            }

            this.scrollTopLatest = this.scrollTop;
            this.scrollHeightLatest = this.scrollHeight;

            const CONDITION = this.scrollHeight - this.scrollTop <= this.clientHeight;
            if (CONDITION) {
                binding.value && binding.value();
            }
        });
    }
};
