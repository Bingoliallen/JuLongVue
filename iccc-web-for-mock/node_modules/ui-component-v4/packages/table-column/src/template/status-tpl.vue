<!--
    标签模板
    @Author: tangDM
    @Date: 2019-03-07
-->
<template>
    <div class="dg-tpl__status" v-if="sourceData[labelName]">
        <p class="dg-tpl__status--name">
            <i class="dg-tpl__status--status" :class="sourceData.icon" :style="styleColour"></i>
            <span class="dg-tpl__status--label">{{ sourceData[labelName] }}</span>
        </p>
    </div>
</template>

<script>
import XEUtils from 'xe-utils';

export default {
    name: 'DgStatusTpl',

    props: {
        // 模板配置
        value: [String, Number, Boolean],
        fn: {
            type: [String, Number, Boolean, Object, Function],
            default: val => val
        },
        scope: Object,
        // 显示配置
        options: {
            type: Array,
            default: () => {
                return [
                    {
                        status: '1',
                        icon: 'el-icon-success',
                        color: '#67c23a',
                        name: '已签收'
                    },
                    {
                        status: '2',
                        icon: 'el-icon-warning',
                        color: '#f04134',
                        name: '未签收'
                    },
                    {
                        status: '0',
                        icon: 'el-icon-info',
                        color: '#ffa32c',
                        name: '待签收'
                    }
                ];
            }
        },
        valueName: {
            type: String,
            default: 'status'
        },
        labelName: {
            type: String,
            default: 'name'
        }
    },

    computed: {
        // 处理数据
        sourceData() {
            const { valueName } = this;
            let _status = this.value;
            let _data = {};
            if (XEUtils.isFunction(this.fn)) {
                _status = this.fn(this.scope);
            } else if (this.fn) {
                _status = this.fn;
            }

            if (XEUtils.isObject(_status)) {
                return _status;
            }

            this.options.forEach(item => {
                if (item[valueName] === _status) {
                    _data = item;
                }
            });

            return _data;
        },
        styleColour() {
            return 'color: ' + this.sourceData.color + ';';
        }
    }
};
</script>
